<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VMC Helty Card - Interactive Demo</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        
        .demo-container {
            max-width: 1200px;
            margin: 0 auto;
            background: rgba(255,255,255,0.95);
            border-radius: 16px;
            padding: 30px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
        }
        
        .demo-header {
            text-align: center;
            margin-bottom: 30px;
        }
        
        .demo-header h1 {
            margin: 0;
            color: #333;
            font-size: 2.5rem;
            background: linear-gradient(45deg, #2196f3, #4caf50);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .demo-header p {
            color: #666;
            font-size: 1.1rem;
            margin: 10px 0;
        }
        
        .demo-controls {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 30px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 12px;
        }
        
        .control-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }
        
        .control-group label {
            font-weight: 500;
            color: #333;
            font-size: 0.9rem;
        }
        
        .control-group input,
        .control-group select {
            padding: 8px 12px;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: 14px;
        }
        
        .control-group button {
            padding: 10px 16px;
            background: #2196f3;
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 500;
            transition: background 0.2s;
        }
        
        .control-group button:hover {
            background: #1976d2;
        }
        
        .demo-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .card-wrapper {
            background: white;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }
        
        .card-title {
            background: #2196f3;
            color: white;
            padding: 12px 16px;
            font-weight: 500;
            margin: 0;
        }
        
        .demo-info {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 30px;
        }
        
        .info-card {
            background: white;
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        
        .info-card h3 {
            margin-top: 0;
            color: #2196f3;
        }
        
        .feature-list {
            list-style: none;
            padding: 0;
        }
        
        .feature-list li {
            padding: 5px 0;
            color: #555;
        }
        
        .feature-list li:before {
            content: "‚úÖ ";
            margin-right: 8px;
        }
        
        /* CSS Variables for theming */
        :root {
            --primary-color: #2196f3;
            --success-color: #4caf50;
            --warning-color: #ff9800;
            --error-color: #f44336;
            --info-color: #2196f3;
            --disabled-color: #9e9e9e;
            --divider-color: #e0e0e0;
            --card-background-color: white;
            --primary-text-color: #212121;
            --secondary-text-color: #757575;
            --secondary-background-color: #f5f5f5;
        }
        
        @media (max-width: 768px) {
            .demo-container {
                padding: 15px;
                margin: 10px;
            }
            
            .demo-header h1 {
                font-size: 2rem;
            }
            
            .demo-controls {
                grid-template-columns: 1fr;
            }
            
            .demo-cards {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="demo-container">
        <div class="demo-header">
            <h1>üå¨Ô∏è VMC Helty Control Card</h1>
            <p>Interactive demonstration of the custom Lovelace card</p>
        </div>
        
        <div class="demo-controls">
            <div class="control-group">
                <label>Fan Speed</label>
                <select id="fanSpeed">
                    <option value="0">OFF</option>
                    <option value="25">Speed 1</option>
                    <option value="50" selected>Speed 2</option>
                    <option value="75">Speed 3</option>
                    <option value="100">Speed 4</option>
                </select>
            </div>
            
            <div class="control-group">
                <label>Internal Temperature (¬∞C)</label>
                <input type="number" id="tempInternal" value="22.5" step="0.1" min="15" max="35">
            </div>
            
            <div class="control-group">
                <label>Humidity (%)</label>
                <input type="number" id="humidity" value="45" step="1" min="20" max="80">
            </div>
            
            <div class="control-group">
                <label>CO‚ÇÇ (ppm)</label>
                <input type="number" id="co2" value="650" step="10" min="400" max="2000">
            </div>
            
            <div class="control-group">
                <label>External Temperature (¬∞C)</label>
                <input type="number" id="tempExternal" value="18.3" step="0.1" min="0" max="40">
            </div>
            
            <div class="control-group">
                <label>VOC (IAQ)</label>
                <input type="number" id="voc" value="85" step="5" min="0" max="500">
            </div>
            
            <div class="control-group">
                <label>Night Mode</label>
                <select id="nightMode">
                    <option value="off" selected>OFF</option>
                    <option value="on">ON</option>
                </select>
            </div>
            
            <div class="control-group">
                <label>Update Demo</label>
                <button onclick="updateDemo()">Apply Changes</button>
            </div>
        </div>
        
        <div class="demo-cards">
            <div class="card-wrapper">
                <h3 class="card-title">üéõÔ∏è Full Card</h3>
                <vmc-helty-card id="fullCard"></vmc-helty-card>
            </div>
            
            <div class="card-wrapper">
                <h3 class="card-title">üì± Compact Card</h3>
                <vmc-helty-compact-card id="compactCard"></vmc-helty-compact-card>
            </div>
        </div>
        
        <div class="demo-info">
            <div class="info-card">
                <h3>üé® Card Features</h3>
                <ul class="feature-list">
                    <li>Real-time fan speed control</li>
                    <li>Environmental sensor monitoring</li>
                    <li>Color-coded status indicators</li>
                    <li>Responsive design for all devices</li>
                    <li>Multiple layout themes</li>
                    <li>Visual configuration editor</li>
                </ul>
            </div>
            
            <div class="info-card">
                <h3>üîß Installation</h3>
                <p><strong>1.</strong> Copy card files to <code>/config/www/vmc-helty-card/</code></p>
                <p><strong>2.</strong> Add resource in Lovelace:</p>
                <code>url: /local/vmc-helty-card/vmc-helty-card.js</code>
                <p><strong>3.</strong> Add card to dashboard with your VMC entity</p>
            </div>
            
            <div class="info-card">
                <h3>üì± Compatibility</h3>
                <ul class="feature-list">
                    <li>VMC Helty Flow Plus/Elite</li>
                    <li>Home Assistant ‚â•2024.1.0</li>
                    <li>Modern browsers (Chrome, Firefox, Safari)</li>
                    <li>Mobile and desktop devices</li>
                </ul>
            </div>
            
            <div class="info-card">
                <h3>üéØ Configuration</h3>
                <pre style="background: #f5f5f5; padding: 10px; border-radius: 4px; font-size: 12px; overflow-x: auto;">type: custom:vmc-helty-card
entity: fan.vmc_helty
name: "Living Room VMC"
show_temperature: true
show_humidity: true
show_co2: true
show_voc: true</pre>
            </div>
        </div>
    </div>

    <!-- Mock Home Assistant Components -->
    <script>
        // Mock ha-icon component
        if (!customElements.get('ha-icon')) {
            class MockHaIcon extends HTMLElement {
                connectedCallback() {
                    const icon = this.getAttribute('icon') || 'mdi:help';
                    this.innerHTML = this.getIconChar(icon);
                }
                
                static get observedAttributes() {
                    return ['icon'];
                }
                
                attributeChangedCallback() {
                    const icon = this.getAttribute('icon') || 'mdi:help';
                    this.innerHTML = this.getIconChar(icon);
                }
                
                getIconChar(iconName) {
                    const icons = {
                        'mdi:fan': '<span style="font-size: inherit;">üå™Ô∏è</span>',
                        'mdi:thermometer': '<span style="font-size: inherit;">üå°Ô∏è</span>',
                        'mdi:thermometer-lines': '<span style="font-size: inherit;">üå°Ô∏è</span>',
                        'mdi:water-percent': '<span style="font-size: inherit;">üíß</span>',
                        'mdi:molecule-co2': '<span style="font-size: inherit;">ü´Å</span>',
                        'mdi:chart-line-variant': '<span style="font-size: inherit;">üìà</span>',
                        'mdi:wifi': '<span style="font-size: inherit;">üì∂</span>',
                        'mdi:wifi-off': '<span style="font-size: inherit;">üìµ</span>',
                        'mdi:power': '<span style="font-size: inherit;">‚ö°</span>',
                        'mdi:fan-speed-1': '<span style="font-size: inherit;">1Ô∏è‚É£</span>',
                        'mdi:fan-speed-2': '<span style="font-size: inherit;">2Ô∏è‚É£</span>',
                        'mdi:fan-speed-3': '<span style="font-size: inherit;">3Ô∏è‚É£</span>',
                        'mdi:fan-plus': '<span style="font-size: inherit;">‚ûï</span>',
                        'mdi:sleep': '<span style="font-size: inherit;">üò¥</span>',
                        'mdi:fast-forward': '<span style="font-size: inherit;">‚è©</span>',
                        'mdi:snowflake': '<span style="font-size: inherit;">‚ùÑÔ∏è</span>',
                        'mdi:water': '<span style="font-size: inherit;">üíß</span>',
                        'mdi:account-heart': '<span style="font-size: inherit;">üòä</span>'
                    };
                    return icons[iconName] || '<span style="font-size: inherit;">‚ùì</span>';
                }
            }
            customElements.define('ha-icon', MockHaIcon);
        }
        
        // Mock ha-card component
        if (!customElements.get('ha-card')) {
            class MockHaCard extends HTMLElement {
                connectedCallback() {
                    this.style.display = 'block';
                    this.style.background = 'var(--card-background-color, white)';
                    this.style.borderRadius = '8px';
                    this.style.boxShadow = '0 2px 8px rgba(0,0,0,0.1)';
                }
            }
            customElements.define('ha-card', MockHaCard);
        }
    </script>

    <!-- Load VMC Helty Cards -->
    <script type="module">
        let mockHass;
        
        // Initialize demo
        async function initDemo() {
            try {
                // Load card modules
                await import('./vmc-helty-card.js');
                await import('./vmc-helty-compact-card.js');
                
                // Setup mock data
                setupMockHass();
                
                // Configure cards
                setupCards();
                
                console.log('‚úÖ Demo initialized successfully');
            } catch (error) {
                console.error('‚ùå Demo initialization failed:', error);
                alert(`Demo failed to load: ${error.message}\n\nMake sure you're serving this page from the same directory as the card files.`);
            }
        }
        
        function setupMockHass() {
            mockHass = {
                states: {
                    'fan.vmc_helty_demo': {
                        state: 'on',
                        attributes: {
                            percentage: 50,
                            friendly_name: 'Demo VMC Fan'
                        }
                    },
                    'sensor.vmc_helty_demo_temperature_internal': {
                        state: '22.5',
                        attributes: {
                            unit_of_measurement: '¬∞C',
                            friendly_name: 'Internal Temperature'
                        }
                    },
                    'sensor.vmc_helty_demo_temperature_external': {
                        state: '18.3',
                        attributes: {
                            unit_of_measurement: '¬∞C',
                            friendly_name: 'External Temperature'
                        }
                    },
                    'sensor.vmc_helty_demo_humidity': {
                        state: '45',
                        attributes: {
                            unit_of_measurement: '%',
                            friendly_name: 'Humidity'
                        }
                    },
                    'sensor.vmc_helty_demo_co2': {
                        state: '650',
                        attributes: {
                            unit_of_measurement: 'ppm',
                            friendly_name: 'CO‚ÇÇ'
                        }
                    },
                    'sensor.vmc_helty_demo_voc': {
                        state: '85',
                        attributes: {
                            unit_of_measurement: 'IAQ',
                            friendly_name: 'VOC'
                        }
                    },
                    'sensor.vmc_helty_demo_dew_point': {
                        state: '12.1',
                        attributes: {
                            unit_of_measurement: '¬∞C',
                            friendly_name: 'Dew Point'
                        }
                    },
                    'sensor.vmc_helty_demo_comfort_index': {
                        state: 'Optimal',
                        attributes: {
                            friendly_name: 'Comfort Index'
                        }
                    },
                    'switch.vmc_helty_demo_night_mode': {
                        state: 'off',
                        attributes: {
                            friendly_name: 'Night Mode'
                        }
                    },
                    'switch.vmc_helty_demo_hyperventilation': {
                        state: 'off',
                        attributes: {
                            friendly_name: 'Hyperventilation'
                        }
                    },
                    'switch.vmc_helty_demo_free_cooling': {
                        state: 'off',
                        attributes: {
                            friendly_name: 'Free Cooling'
                        }
                    }
                },
                callService: (domain, service, data) => {
                    console.log(`üîß Service call: ${domain}.${service}`, data);
                    
                    // Simulate service calls
                    if (domain === 'fan') {
                        if (service === 'turn_off') {
                            mockHass.states['fan.vmc_helty_demo'].state = 'off';
                            mockHass.states['fan.vmc_helty_demo'].attributes.percentage = 0;
                        } else if (service === 'set_percentage') {
                            mockHass.states['fan.vmc_helty_demo'].state = data.percentage > 0 ? 'on' : 'off';
                            mockHass.states['fan.vmc_helty_demo'].attributes.percentage = data.percentage;
                        }
                        updateCards();
                    }
                    
                    return Promise.resolve();
                }
            };
        }
        
        function setupCards() {
            const fullCard = document.getElementById('fullCard');
            const compactCard = document.getElementById('compactCard');
            
            if (fullCard) {
                fullCard.setConfig({
                    entity: 'fan.vmc_helty_demo',
                    name: 'Demo VMC System',
                    show_temperature: true,
                    show_humidity: true,
                    show_co2: true,
                    show_voc: true,
                    show_advanced: true
                });
                fullCard.hass = mockHass;
            }
            
            if (compactCard) {
                compactCard.setConfig({
                    entity: 'fan.vmc_helty_demo',
                    name: 'Compact VMC'
                });
                compactCard.hass = mockHass;
            }
        }
        
        function updateCards() {
            const fullCard = document.getElementById('fullCard');
            const compactCard = document.getElementById('compactCard');
            
            if (fullCard && fullCard.hass) {
                fullCard.hass = { ...mockHass };
            }
            if (compactCard && compactCard.hass) {
                compactCard.hass = { ...mockHass };
            }
        }
        
        // Make updateDemo available globally
        window.updateDemo = function() {
            // Update mock data from controls
            const fanSpeed = document.getElementById('fanSpeed').value;
            const tempInternal = document.getElementById('tempInternal').value;
            const tempExternal = document.getElementById('tempExternal').value;
            const humidity = document.getElementById('humidity').value;
            const co2 = document.getElementById('co2').value;
            const voc = document.getElementById('voc').value;
            const nightMode = document.getElementById('nightMode').value;
            
            // Update mock states
            mockHass.states['fan.vmc_helty_demo'].state = fanSpeed > 0 ? 'on' : 'off';
            mockHass.states['fan.vmc_helty_demo'].attributes.percentage = parseInt(fanSpeed);
            mockHass.states['sensor.vmc_helty_demo_temperature_internal'].state = tempInternal;
            mockHass.states['sensor.vmc_helty_demo_temperature_external'].state = tempExternal;
            mockHass.states['sensor.vmc_helty_demo_humidity'].state = humidity;
            mockHass.states['sensor.vmc_helty_demo_co2'].state = co2;
            mockHass.states['sensor.vmc_helty_demo_voc'].state = voc;
            mockHass.states['switch.vmc_helty_demo_night_mode'].state = nightMode;
            
            // Update comfort index based on humidity
            const humidityNum = parseInt(humidity);
            let comfort = 'Optimal';
            if (humidityNum < 30) comfort = 'Dry';
            else if (humidityNum > 70) comfort = 'Humid';
            else if (humidityNum > 60) comfort = 'Acceptable';
            mockHass.states['sensor.vmc_helty_demo_comfort_index'].state = comfort;
            
            // Update dew point (simplified calculation)
            const temp = parseFloat(tempInternal);
            const rh = parseFloat(humidity);
            const dewPoint = temp - ((100 - rh) / 5); // Simplified formula
            mockHass.states['sensor.vmc_helty_demo_dew_point'].state = dewPoint.toFixed(1);
            
            // Refresh cards
            updateCards();
            
            console.log('üîÑ Demo updated with new values');
        };
        
        // Initialize when page loads
        initDemo();
    </script>
</body>
</html>